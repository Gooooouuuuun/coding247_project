<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kosmo.team.project.dao.RecordsDAO">
	<!-- 전체 순위 -->
	<select id="getRecordsRankingTabAll" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		select
		    m.nickname AS "nickname",
		    p.games_played as "games_played",
		    p.wins as "wins",
		    p.draws as "draws",
		    p.losses as "losses",
		    p.goals_for as "goals_for",
		    p.goals_assist as "goals_assist"  
		from
		    member m, player_record p
		where
		    p.player = m.m_no
		<if test="sortTabAll == null or sortTabAll.isEmpty()">
		    order by games_played desc
		</if>
		<if test="sortTabAll != null and !sortTabAll.isEmpty()">
		    order by ${sortTabAll}
		</if>
	</select>
	
	<select id="getRecordsRankingTabAllListCnt" resultType="int">
		select 
			count(*) 
		from
		    player_record
	</select>
	
	<select id="getRecordsGoalRatingTabAll" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_for as "goals_for"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		ORDER BY 
			p.goals_for DESC
	</select>
	
	<select id="getRecordsWinRatingTabAll" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.wins as "wins"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		ORDER BY 
			p.wins DESC
	</select>
	
	<select id="getRecordsAssistRatingTabAll" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_assist as "goals_assist"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		ORDER BY 
			p.goals_assist DESC
	</select>
	
	<!-- 지역별 순위 -->
	
	<select id="getRecordsRankingTabRegion" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		select
		    m.nickname AS "nickname",
		    p.games_played as "games_played",
		    p.wins as "wins",
		    p.draws as "draws",
		    p.losses as "losses",
		    p.goals_for as "goals_for",
		    p.goals_assist as "goals_assist",
			s.name AS "region"  
		from
		    member m, player_record p, sido s
		where
			1=1
			and
		    p.player = m.m_no
		    and
		    m.sido_id = s.sido_id
		    <if test="sido_id != null">
		    	and
		    	m.sido_id=#{sido_id}
		    </if>
		<if test="sortTabRegion == null or sortTabRegion.isEmpty()">
		    order by games_played desc
		</if>
		<if test="sortTabRegion != null and !sortTabRegion.isEmpty()">
		    order by ${sortTabRegion}
		</if>
	</select>
	
	<select id="getRecordsRankingTabRegionListCnt" resultType="int">
		select 
			count(*) 
		from
		    player_record
	</select>
	
	<select id="getRecordsGoalRatingTabRegion" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_for as "goals_for"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <if test="sido_id != null">
		    	and
		    	m.sido_id=#{sido_id}
		    </if>
		ORDER BY 
			p.goals_for DESC
	</select>
	
	<select id="getRecordsWinRatingTabRegion" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.wins as "wins"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <if test="sido_id != null">
		    	and
		    	sido_id=#{sido_id}
		    </if>
		ORDER BY 
			p.wins DESC
	</select>
	
	<select id="getRecordsAssistRatingTabRegion" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_assist as "goals_assist"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <if test="sido_id != null">
		    	and
		    	sido_id=#{sido_id}
		    </if>
		ORDER BY 
			p.goals_assist DESC
	</select>
	
	<!-- 성별 순위 -->
	
	<select id="getRecordsRankingTabGender" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		select
		    m.nickname AS "nickname",
		    p.games_played as "games_played",
		    p.wins as "wins",
		    p.draws as "draws",
		    p.losses as "losses",
		    p.goals_for as "goals_for",
		    p.goals_assist as "goals_assist",
			m.gender as "gender"
		from
		    member m, player_record p
		where
			1=1
			and
		    p.player = m.m_no
		    <if test="gender != null">
		    	and
		    	m.gender='${gender}'
		    </if>
		<if test="sortTabGender == null or sortTabGender.isEmpty()">
		    order by games_played desc
		</if>
		<if test="sortTabGender != null and !sortTabGender.isEmpty()">
		    order by ${sortTabGender}
		</if>
	</select>
	
	<select id="getRecordsRankingTabGenderListCnt" resultType="int">
		select 
			count(*) 
		from
		    player_record
	</select>
	
	<select id="getRecordsGoalRatingTabGender" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_for as "goals_for"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		   <if test="gender != null">
		    	and
		    	m.gender='${gender}'
		    </if>
		ORDER BY 
			p.goals_for DESC
	</select>
	
	<select id="getRecordsWinRatingTabGender" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.wins as "wins"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <if test="gender != null">
		    	and
		    	m.gender='${gender}'
		    </if>
		ORDER BY 
			p.wins DESC
	</select>
	
	<select id="getRecordsAssistRatingTabGender" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_assist as "goals_assist"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <if test="gender != null">
		    	and
		    	m.gender='${gender}'
		    </if>
		ORDER BY 
			p.goals_assist DESC
	</select>
	
	<!-- 연령대별 순위 -->
	
	<select id="getRecordsRankingTabAge" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		select
		    m.nickname AS "nickname",
		    p.games_played as "games_played",
		    p.wins as "wins",
		    p.draws as "draws",
		    p.losses as "losses",
		    p.goals_for as "goals_for",
		    p.goals_assist as "goals_assist",
			m.birthdate as "birthdate"
		from
		    member m, player_record p
		where
			1=1
			and
		    p.player = m.m_no
		    <choose>
	            <when test="age != null and age == '10대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 10 AND 19)
	            </when>
	            <when test="age != null and age == '20대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 20 AND 29)
	            </when>
	            <when test="age != null and age == '30대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 30 AND 39)
	            </when>
	            <when test="age != null and age == '40대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 40 AND 49)
	            </when>
	            <when test="age != null and age == '50대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 50 AND 59)
	            </when>
	            <when test="age != null and age == '60대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 60 AND 69)
	            </when>
	            <when test="age != null and age == '70대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 70 AND 79)
	            </when>
	            <when test="age != null and age == '80대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 80 AND 89)
	            </when>
	        </choose>
		<if test="sortTabAge == null or sortTabAge.isEmpty()">
		    order by games_played desc
		</if>
		<if test="sortTabAge != null and !sortTabAge.isEmpty()">
		    order by ${sortTabAge}
		</if>
	</select>
	
	<select id="getRecordsRankingTabAgeListCnt" resultType="int">
		select 
			count(*) 
		from
		    player_record
	</select>
	
	<select id="getRecordsGoalRatingTabAge" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_for as "goals_for"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		   <choose>
	            <when test="age != null and age == '10대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 10 AND 19)
	            </when>
	            <when test="age != null and age == '20대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 20 AND 29)
	            </when>
	            <when test="age != null and age == '30대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 30 AND 39)
	            </when>
	            <when test="age != null and age == '40대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 40 AND 49)
	            </when>
	            <when test="age != null and age == '50대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 50 AND 59)
	            </when>
	            <when test="age != null and age == '60대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 60 AND 69)
	            </when>
	            <when test="age != null and age == '70대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 70 AND 79)
	            </when>
	            <when test="age != null and age == '80대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 80 AND 89)
	            </when>
	        </choose>
		ORDER BY 
			p.goals_for DESC
	</select>
	
	<select id="getRecordsWinRatingTabAge" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.wins as "wins"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <choose>
	            <when test="age != null and age == '10대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 10 AND 19)
	            </when>
	            <when test="age != null and age == '20대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 20 AND 29)
	            </when>
	            <when test="age != null and age == '30대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 30 AND 39)
	            </when>
	            <when test="age != null and age == '40대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 40 AND 49)
	            </when>
	            <when test="age != null and age == '50대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 50 AND 59)
	            </when>
	            <when test="age != null and age == '60대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 60 AND 69)
	            </when>
	            <when test="age != null and age == '70대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 70 AND 79)
	            </when>
	            <when test="age != null and age == '80대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 80 AND 89)
	            </when>
	        </choose>
		ORDER BY 
			p.wins DESC
	</select>
	
	<select id="getRecordsAssistRatingTabAge" resultType="kosmo.team.project.dto.RecordsDTO" parameterType="kosmo.team.project.dto.RecordsDTO">
		SELECT
			m.nickname AS "nickname",
			p.goals_assist as "goals_assist"
		FROM 
			member m, player_record p
		where
		    p.player = m.m_no
		    <choose>
	            <when test="age != null and age == '10대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 10 AND 19)
	            </when>
	            <when test="age != null and age == '20대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 20 AND 29)
	            </when>
	            <when test="age != null and age == '30대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 30 AND 39)
	            </when>
	            <when test="age != null and age == '40대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 40 AND 49)
	            </when>
	            <when test="age != null and age == '50대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 50 AND 59)
	            </when>
	            <when test="age != null and age == '60대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 60 AND 69)
	            </when>
	            <when test="age != null and age == '70대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 70 AND 79)
	            </when>
	            <when test="age != null and age == '80대'">
	                AND ((TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) - TO_NUMBER(TO_CHAR(m.birthdate, 'YYYY'))) BETWEEN 80 AND 89)
	            </when>
	        </choose>
		ORDER BY 
			p.goals_assist DESC
	</select>
</mapper>